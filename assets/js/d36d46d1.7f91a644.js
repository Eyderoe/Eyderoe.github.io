"use strict";(globalThis.webpackChunkeyderoe_blog=globalThis.webpackChunkeyderoe_blog||[]).push([[2273],{8453:(e,r,t)=>{t.d(r,{R:()=>s,x:()=>l});var n=t(6540);const o={},i=n.createContext(o);function s(e){const r=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(i.Provider,{value:r},e.children)}},9241:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>c,frontMatter:()=>s,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"\u6742\u8bb0/PowerShell","title":"PowerShell","description":"\u867d\u7136 LLM \u53d1\u5c55\u5f88\u5feb\u4e86 \u5df2\u7ecf\uff0c\u4f46\u8fd8\u662f\u7a0d\u5fae\u8bb0\u8bb0","source":"@site/docs/\u6742\u8bb0/PowerShell.mdx","sourceDirName":"\u6742\u8bb0","slug":"/\u6742\u8bb0/PowerShell","permalink":"/docs/\u6742\u8bb0/PowerShell","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\u6742\u8bb0","permalink":"/docs/category/\u6742\u8bb0"},"next":{"title":"Adobe","permalink":"/docs/\u6742\u8bb0/Adobe"}}');var o=t(4848),i=t(8453);const s={sidebar_position:1},l="PowerShell",a={},h=[{value:"\u6587\u4ef6\u6811\u751f\u6210",id:"\u6587\u4ef6\u6811\u751f\u6210",level:2},{value:"\u4ee3\u7406",id:"\u4ee3\u7406",level:2}];function p(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"powershell",children:"PowerShell"})}),"\n",(0,o.jsx)(r.p,{children:"\u867d\u7136 LLM \u53d1\u5c55\u5f88\u5feb\u4e86 \u5df2\u7ecf\uff0c\u4f46\u8fd8\u662f\u7a0d\u5fae\u8bb0\u8bb0"}),"\n",(0,o.jsx)(r.h2,{id:"\u6587\u4ef6\u6811\u751f\u6210",children:"\u6587\u4ef6\u6811\u751f\u6210"}),"\n",(0,o.jsx)(r.p,{children:"\u51fd\u6570"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-powershell",children:'function Show-Tree {\r\n    param (\r\n        [string]$Path = ".",\r\n        [int]$Depth = 2,\r\n        [int]$CurrentDepth = 0,\r\n        [string]$Prefix = "",\r\n        [int]$Max = 5\r\n    )\r\n    # \u8f93\u51fa\u7236\u6587\u4ef6\u5939\u540d\u79f0\r\n    if ($CurrentDepth -eq 0) {\r\n        Write-Output "$(Split-Path -Leaf $Path)"\r\n    }\r\n    $items = Get-ChildItem -Path $Path\r\n    # \u9650\u5236\u663e\u793a\u7684\u9879\u76ee\u6570\u91cf\r\n    $itemsToShow = if ($items.Count -gt $Max) { $items[0..($Max-1)] } else { $items }\r\n    for ($i = 0; $i -lt $itemsToShow.Count; $i++) {\r\n        $item = $itemsToShow[$i]\r\n        $isLast = ($i -eq $itemsToShow.Count - 1)\r\n        # \u5982\u679c\u5b9e\u9645\u9879\u76ee\u6570\u8d85\u8fc7Max\uff0c\u4e14\u8fd9\u662f\u6700\u540e\u4e00\u4e2a\u663e\u793a\u7684\u9879\u76ee\uff0c\u5219\u663e\u793a\u7701\u7565\u4fe1\u606f\r\n        if ($items.Count -gt $Max -and $isLast) {\r\n            Write-Output "$Prefix\u2514\u2500\u2500 ... ($($items.Count - $Max) more items)"\r\n            break\r\n        }\r\n        if ($isLast) {\r\n            Write-Output "$Prefix\u2514\u2500\u2500 $($item.Name)"\r\n            $newPrefix = "$Prefix    "\r\n        } else {\r\n            Write-Output "$Prefix\u251c\u2500\u2500 $($item.Name)"\r\n            $newPrefix = "$Prefix\u2502   "\r\n        }\r\n        # \u9012\u5f52\u663e\u793a\u5b50\u76ee\u5f55\r\n        if ($item.PSIsContainer -and $CurrentDepth -lt $Depth) {\r\n            Show-Tree -Path $item.FullName -Depth $Depth -CurrentDepth ($CurrentDepth + 1) -Prefix $newPrefix -Max $Max\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(r.p,{children:"\u547d\u4ee4"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-powershell",children:"Show-Tree -Depth 2\n"})}),"\n",(0,o.jsx)(r.h2,{id:"\u4ee3\u7406",children:"\u4ee3\u7406"}),"\n",(0,o.jsx)(r.p,{children:"\u5f00\u542f\u4ee3\u7406"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-powershell",children:'function proxy {\r\n    param(\r\n        [int]$httpPort = 7899,  # \u9ed8\u8ba4 HTTP/HTTPS \u4ee3\u7406\u7aef\u53e3\r\n        [int]$socksPort = 7898  # \u9ed8\u8ba4 SOCKS \u4ee3\u7406\u7aef\u53e3\r\n    )\r\n    $env:HTTP_PROXY = "http://127.0.0.1:$httpPort"\r\n    $env:HTTPS_PROXY = "http://127.0.0.1:$httpPort"\r\n    $env:http_proxy = "http://127.0.0.1:$httpPort"\r\n    $env:https_proxy = "http://127.0.0.1:$httpPort"\r\n    [System.Net.WebRequest]::DefaultWebProxy = New-Object System.Net.WebProxy("http://127.0.0.1:$httpPort")\r\n    Write-Host "\u2713 \u4ee3\u7406\u5df2\u542f\u7528: http://127.0.0.1:$httpPort" -ForegroundColor Green\r\n    Write-Host "\u2713 SOCKS \u4ee3\u7406\u7aef\u53e3: $socksPort" -ForegroundColor Green\r\n    Write-Host "\u2713 \u6d4b\u8bd5\u8fde\u63a5\u4e2d..." -ForegroundColor Yellow\r\n    try {\r\n        $response = Invoke-WebRequest -Uri "https://www.google.com" -TimeoutSec 10\r\n        Write-Host "\u2713 \u4ee3\u7406\u5de5\u4f5c\u6b63\u5e38\uff01" -ForegroundColor Green\r\n    }\r\n    catch {\r\n        Write-Host "\u2717 \u4ee3\u7406\u53ef\u80fd\u6709\u95ee\u9898: $($_.Exception.Message)" -ForegroundColor Red\r\n    }\r\n}\n'})}),"\n",(0,o.jsx)(r.p,{children:"\u5173\u95ed\u4ee3\u7406"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-powershell",children:'function unproxy {\r\n    $env:HTTP_PROXY = ""\r\n    $env:HTTPS_PROXY = ""\r\n    $env:http_proxy = ""\r\n    $env:https_proxy = ""\r\n    [System.Net.WebRequest]::DefaultWebProxy = $null\r\n    git config --global --unset http.proxy\r\n    git config --global --unset https.proxy\r\n    Write-Host "\u2713 \u4ee3\u7406\u5df2\u7981\u7528" -ForegroundColor Green\r\n}\n'})})]})}function c(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}}}]);